{% extends 'admin/admin_base.html' %}

{% block title %}Admin Dashboard{% endblock %}

{% block content %}
    <div class="admin-container">
        <div class="card">
            <h2>Users Online</h2>
            <ul>
                {% for user in users %}
                {% if user.is_online %}<li>{{ user.username }}</li>{% endif %}
                {% endfor %}
            </ul>
        </div>

        <div class="card">
            <h2>Conversation Management</h2>
            <button id="toggle-ai-button">
                {{ 'Disable' if config.ai_teacher_enabled else 'Enable' }} AI Teacher
            </button>

            <button id="start-conversation-button">
                Start New Conversation
            </button>

            <button id="toggle-message-sending-button">
                {{ 'Disable' if config.message_sending_enabled else 'Enable' }} Message Sending
            </button>
        </div>

        <div class="card">
            <h2>Ban A Word</h2>
            <input type="text" id="ban-word" placeholder="Enter new banned word" required>
            <textarea id="ban-reason" placeholder="Enter reason (optional)"></textarea>
            <button id="add-banned-word-button">Add Word</button>
        </div>

        <div class="card">
            <h2>Adjust Ducks</h2>
            <label for="username">User:</label>
            <select id="duck-username" required>
                {% for user in users|sort(attribute='username') %}
                    <option value="{{ user.username }}">{{ user.username }}</option>
                {% endfor %}
            </select>
            <label for="amount">Amount:</label>
            <input type="number" id="duck-amount" required placeholder="Enter amount (+/-)">
            <button id="update-ducks-button">Update Ducks</button>
        </div>

        <div class="card">
            <h2>Trades</h2>
            <a href="/admin/pending_trades">
                <button>Pending Trades</button>
            </a>
            <a href="/admin/trades">
                <button>Trade Logs</button>
            </a>
        </div>
    </div>

    <!-- Pass URLs as data attributes to the JavaScript -->
    <script>
        window.urls = {
            toggleAiUrl: "{{ url_for('admin_bp.toggle_ai') }}",
            startConversationUrl: "{{ url_for('message_bp.start_conversation') }}",
            toggleMessageSendingUrl: "{{ url_for('admin_bp.toggle_message_sending') }}",
            addBannedWordUrl: "{{ url_for('admin_bp.add_banned_word') }}",
            adjustDucksUrl: "{{ url_for('admin_bp.adjust_ducks') }}",
        };
    </script>

    <!-- Link to external JS file -->
    <script src="{{ url_for('static', filename='js/admin/admin2.js') }}"></script>
{% endblock %}
