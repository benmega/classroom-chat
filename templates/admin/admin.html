{% extends 'admin/admin_base.html' %}

{% block title %}Admin Dashboard{% endblock %}

{% block content %}
    <div class="admin-container">
        <div class="admin-grid">
            <div class="admin-card">
                <h2 class="card-title">Users Online</h2>
                <div class="card-content">
                    <ul class="user-list">
                        {% for user in users %}
                        {% if user.is_online %}<li>{{ user.username }}</li>{% endif %}
                        {% endfor %}
                    </ul>
                </div>
            </div>

            <div class="admin-card">
                <h2 class="card-title">Conversation Management</h2>
                <div class="card-content button-group">
                    <button id="toggle-ai-button" class="admin-button primary">
                        {{ 'Disable' if config.ai_teacher_enabled else 'Enable' }} AI Teacher
                    </button>
                    <button id="start-conversation-button" class="admin-button secondary">
                        Start New Conversation
                    </button>
                    <button id="toggle-message-sending-button" class="admin-button primary">
                        {{ 'Disable' if config.message_sending_enabled else 'Enable' }} Message Sending
                    </button>
                </div>
            </div>

            <div class="admin-card">
                <h2 class="card-title">Ban A Word</h2>
                <div class="card-content">
                    <div class="form-group">
                        <input type="text" id="ban-word" class="admin-input" placeholder="Enter new banned word" required>
                    </div>
                    <div class="form-group">
                        <textarea id="ban-reason" class="admin-textarea" placeholder="Enter reason (optional)"></textarea>
                    </div>
                    <button id="add-banned-word-button" class="admin-button warning">Add Word</button>
                </div>
            </div>

            <div class="admin-card">
                <h2 class="card-title">Adjust Ducks</h2>
                <div class="card-content">
                    <div class="form-group">
                        <label for="duck-username">User:</label>
                        <select id="duck-username" class="admin-select" required>
                            {% for user in users|sort(attribute='username') %}
                                <option value="{{ user.username }}">{{ user.username }}</option>
                            {% endfor %}
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="duck-amount">Amount:</label>
                        <input type="number" id="duck-amount" class="admin-input" required placeholder="Enter amount (+/-)">
                    </div>
                    <button id="update-ducks-button" class="admin-button highlight">Update Ducks</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Pass URLs as data attributes to the JavaScript -->
    <script>
        window.urls = {
            toggleAiUrl: "{{ url_for('admin_bp.toggle_ai') }}",
            startConversationUrl: "{{ url_for('message_bp.start_conversation') }}",
            toggleMessageSendingUrl: "{{ url_for('admin_bp.toggle_message_sending') }}",
            addBannedWordUrl: "{{ url_for('admin_bp.add_banned_word') }}",
            adjustDucksUrl: "{{ url_for('admin_bp.adjust_ducks') }}",
        };
    </script>

    <!-- Link to external JS file -->
    <script src="{{ url_for('static', filename='js/admin/admin2.js') }}"></script>
{% endblock %}